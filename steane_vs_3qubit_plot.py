from matplotlib import pyplot as plt
import numpy as np

N=1000
probs = np.linspace(0, 1, 100, endpoint=False)

steane_plot_data = np.array([1000., 1000.,  994.,  988.,  986.,  987.,  973.,  964.,  942.,  916.,  914.,  899.,
  871.,  866.,  858.,  827.,  808.,  796.,  769.,  716.,  749.,  679.,  652.,  657.,
  607.,  633.,  605.,  540.,  528.,  497.,  499.,  471.,  436.,  443.,  412.,  358.,
  396.,  340.,  330.,  306.,  292.,  274.,  246.,  244.,  212.,  219.,  202.,  181.,
  162.,  145.,  143.,  128.,  114.,  136.,   86.,   99.,   87.,   77.,   74.,   72.,
   58.,   70.,   36.,   36.,   28.,   29.,   35.,   25.,   25.,   25.,   16.,   13.,
   16.,    8.,    6.,    6.,    4.,    5.,    3.,    3.,    1.,    3.,    3.,    1.,
    0.,    0.,    1.,    1.,    0.,    1.,    1.,    1.,    0.,    0.,    0.,    0.,
    0.,    0.,    0.,    0.])


a3qubit_plot_data = np.array([1000., 1000.,  998.,  997.,  994.,  993.,  989.,  982.,  975.,  976.,  961.,  969.,
  966.,  957.,  951.,  935.,  932.,  904.,  918.,  898.,  897.,  890.,  884.,  869.,
  844.,  849.,  809.,  829.,  796.,  767.,  793.,  762.,  771.,  745.,  749.,  725.,
  713.,  678.,  666.,  650.,  653.,  668.,  622.,  598.,  586.,  582.,  547.,  555.,
  525.,  509.,  487.,  494.,  475.,  448.,  414.,  423.,  402.,  393.,  392.,  366.,
  328.,  308.,  334.,  300.,  296.,  273.,  270.,  258.,  245.,  233.,  220.,  206.,
  209.,  184.,  164.,  165.,  152.,  144.,  139.,  118.,  115.,   94.,   92.,   67.,
   64.,   60.,   46.,   46.,   31.,   38.,   20.,   28.,   16.,   15.,   11.,    7.,
    5.,    5.,    1.,    0.])

plt.plot(probs, steane_plot_data*100/N, color='g', label="Steane Error Correction")
plt.plot(probs, a3qubit_plot_data*100/N, color='b', label="3-Qubit Error Correction")
plt.plot(probs, np.linspace(100, 0, probs.shape[0]), color='orange', linestyle='dashed')
plt.ylabel("% times where correct errors detected")
plt.xlabel("p")
plt.grid()
plt.legend()
# plt.title("Effectiveness of 3-qubit error correction code")
plt.savefig("plots/steane_vs_3qubit.svg")